#!/bin/bash

# üîê CORRE√á√ÉO ESPEC√çFICA - redirect_uri_mismatch
echo "üîê CORRE√á√ÉO - redirect_uri_mismatch"
echo "=================================="
echo ""

echo "‚úÖ PROGRESSO: O backend est√° funcionando!"
echo "‚ùå PROBLEMA: URL de callback n√£o confere no Google Console"
echo ""

echo "üîç DIAGN√ìSTICO DO ERRO:"
echo "---------------------"
echo "Erro 400: redirect_uri_mismatch significa que:"
echo "1. Seu backend est√° enviando uma URL de callback"
echo "2. Mas essa URL N√ÉO est√° configurada no Google Cloud Console"
echo ""

echo "üéØ URLS DE CALLBACK POSS√çVEIS:"
echo "-----------------------------"
echo "Seu backend pode estar usando uma destas URLs:"
echo ""
echo "1. https://bindertcg-backend.onrender.com/auth/google/callback"
echo "2. https://sua-app-customizada.onrender.com/auth/google/callback"
echo "3. http://localhost:5000/auth/google/callback (se BACKEND_URL n√£o estiver configurado)"
echo ""

echo "üîß CORRE√á√ÉO NO GOOGLE CLOUD CONSOLE:"
echo "====================================="
echo ""
echo "1. Acesse: https://console.cloud.google.com"
echo "2. V√° em: APIs & Services ‚Üí Credentials"
echo "3. Clique no seu OAuth 2.0 Client ID"
echo "4. Em 'Authorized redirect URIs', ADICIONE TODAS estas URLs:"
echo ""
echo "   https://bindertcg-backend.onrender.com/auth/google/callback"
echo "   http://localhost:5000/auth/google/callback"
echo ""
echo "5. Clique 'SAVE'"
echo "6. Aguarde 5-10 minutos para propaga√ß√£o"
echo ""

echo "‚ö†Ô∏è  IMPORTANTE:"
echo "Substitua 'bindertcg-backend' pela URL real do seu app no Render!"
echo ""

echo "üîç DESCOBRIR A URL EXATA:"
echo "Se n√£o souber a URL exata, execute:"
echo ""
echo "1. No painel do Render:"
echo "   - Clique no seu app"
echo "   - Copie a URL que aparece no topo"
echo ""
echo "2. Ou teste estas URLs no navegador:"
echo "   - https://bindertcg-backend.onrender.com/"
echo "   - https://seu-app.onrender.com/"
echo ""

echo "üß™ TESTE R√ÅPIDO:"
echo "==============="
echo "Execute este comando para ver qual URL seu backend usa:"
echo ""
echo "# Verificar se o backend responde:"
echo "curl -s https://bindertcg-backend.onrender.com/health"
echo ""
echo "# Se n√£o funcionar, tente descobrir a URL correta:"
echo "curl -s https://seu-app-real.onrender.com/health"
echo ""

echo "üìù CONFIGURA√á√ÉO COMPLETA DO GOOGLE CONSOLE:"
echo "==========================================="
echo ""
echo "Authorized JavaScript origins:"
echo "  https://sua-app.vercel.app"
echo "  http://localhost:3000"
echo "  http://localhost:3001"
echo ""
echo "Authorized redirect URIs:"
echo "  https://bindertcg-backend.onrender.com/auth/google/callback"
echo "  http://localhost:5000/auth/google/callback"
echo ""

echo "‚úÖ AP√ìS CONFIGURAR:"
echo "==================="
echo "1. Aguarde 5-10 minutos"
echo "2. Limpe cache do navegador"
echo "3. Teste o login novamente"
echo "4. Execute: ./test-auth.sh para verificar"
echo ""

echo "üÜò SE AINDA N√ÉO FUNCIONAR:"
echo "=========================="
echo "1. Confirme a URL exata do seu backend"
echo "2. Verifique se adicionou no Google Console"
echo "3. Aguarde mais tempo para propaga√ß√£o"
echo "4. Tente em janela an√¥nima do navegador"
